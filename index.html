This is a solid foundation! You have a full CRUD application with Firebase, Excel import/export, and reporting.

To make it "more pleasing" (better UI/UX) and add value, I have implemented the following upgrades in the code below:

### **Key Features Added:**

1. **Visual Overhaul:**
* **Modern Font:** Switched to "Poppins" (Google Fonts) for a cleaner look.
* **Color Palette:** updated to a professional Navy Blue & White theme (consistent with many government/educational dashboards).
* **Icons:** Added **FontAwesome** for buttons and sidebar items (instead of just text).
* **Animations:** Smooth transitions on hover and section switching.


2. **Dashboard Visualization:**
* **Chart.js Integration:** Added a graphical **Bar Chart** to the dashboard to visualize the data alongside the number cards.


3. **Search Functionality:**
* Added a **Real-time Search Bar** above the MOVs table to filter by title, type, or responsible person instantly.


4. **Better User Experience (UX):**
* **Toast Notifications:** Replaced the annoying browser `alert()` popups with smooth "Toast" notifications (slide-in messages) for success/error events.
* **Link Handling:** Long URLs are now hidden behind a clickable "Link" icon to keep the table tidy.



---

### **Copy & Paste The Complete Code**

Replace your entire file with this version. **Note: I kept your Firebase config placeholder at the bottomâ€”make sure to verify your API keys are correct.**

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PAU-MOVs Dashboard</title>
  <link rel="icon" type="image/png" href="PAU MOVs.png" />
  
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root {
      --primary: #1e3a8a; /* Navy Blue */
      --secondary: #3b82f6; /* Lighter Blue */
      --accent: #f59e0b; /* Amber for highlights */
      --bg: #f3f4f6;
      --text: #1f2937;
      --sidebar-width: 240px;
    }

    * { margin:0; padding:0; box-sizing:border-box; font-family:'Poppins', sans-serif; }
    body { display:flex; height:100vh; color:var(--text); background:var(--bg); overflow: hidden; }

    /* SIDEBAR */
    .sidebar {
      width: var(--sidebar-width);
      background: #111827;
      color: #fff;
      display: flex;
      flex-direction: column;
      box-shadow: 4px 0 10px rgba(0,0,0,0.1);
      transition: all 0.3s;
      z-index: 100;
    }
    .brand { padding: 30px 20px; text-align: center; border-bottom: 1px solid #374151; }
    .brand h2 { font-size: 1.5rem; letter-spacing: 1px; color: #fff; }
    .brand span { color: var(--secondary); }
    
    .sidebar ul { list-style:none; padding: 20px 0; flex: 1; }
    .sidebar li {
      padding: 15px 25px;
      cursor:pointer;
      transition:all .3s;
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 0.95rem;
      border-left: 4px solid transparent;
    }
    .sidebar li:hover { background: rgba(255,255,255,0.05); }
    .sidebar li.active { background: #1f2937; border-left-color: var(--secondary); color: var(--secondary); font-weight: 600; }
    .sidebar li i { width: 20px; text-align: center; }

    /* CONTENT AREA */
    .content { flex:1; padding:30px; overflow-y:auto; position: relative; }
    
    h1 { margin-bottom: 25px; font-weight: 600; color: #111827; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px; }
    
    .section { display:none; animation: fadeIn 0.4s ease; }
    .section.active { display:block; }
    @keyframes fadeIn { from { opacity:0; transform: translateY(10px); } to { opacity:1; transform: translateY(0); } }

    /* CARDS & SUMMARY */
    .summary { display:grid; grid-template-columns:repeat(auto-fit, minmax(180px,1fr)); gap:20px; margin-bottom:30px; }
    .card { background:#fff; padding:20px; border-radius:12px; box-shadow:0 4px 6px rgba(0,0,0,0.05); text-align:center; border-top: 4px solid var(--secondary); transition: transform 0.2s; }
    .card:hover { transform: translateY(-5px); }
    .card h3 { font-size: 0.9rem; color: #6b7280; margin-bottom: 10px; }
    .card p { font-size: 1.8rem; font-weight: 700; color: var(--primary); }

    /* FORMS & INPUTS */
    .input-panel { background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 30px; }
    .input-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(200px,1fr)); gap:15px; align-items: end; }
    
    input, select, button { padding: 10px 15px; border-radius: 6px; border: 1px solid #d1d5db; font-size: 0.9rem; outline: none; transition: 0.2s; width: 100%; }
    input:focus, select:focus { border-color: var(--secondary); box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }
    
    label { font-size: 0.85rem; font-weight: 600; color: #374151; margin-bottom: 5px; display: block; }

    /* BUTTONS */
    .btn { cursor:pointer; font-weight: 500; display: inline-flex; align-items: center; justify-content: center; gap: 8px; border: none; }
    .btn-primary { background: var(--primary); color: #fff; }
    .btn-primary:hover { background: #1e40af; }
    .btn-danger { background: #ef4444; color: #fff; }
    .btn-danger:hover { background: #dc2626; }
    .btn-success { background: #10b981; color: #fff; }
    .btn-success:hover { background: #059669; }
    .btn-secondary { background: #fff; border: 1px solid #d1d5db; color: #374151; }
    .btn-secondary:hover { background: #f9fafb; border-color: #9ca3af; }

    /* TABLES */
    .table-container { background: #fff; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); overflow: hidden; }
    table { width:100%; border-collapse:collapse; }
    thead { background: #f9fafb; border-bottom: 2px solid #e5e7eb; }
    th, td { padding: 15px; text-align: left; font-size: 0.9rem; vertical-align: middle; }
    th { font-weight: 600; color: #374151; cursor: pointer; user-select: none; }
    th:hover { background: #f3f4f6; color: var(--primary); }
    tr:not(:last-child) { border-bottom: 1px solid #e5e7eb; }
    tbody tr:hover { background: #f9fafb; }
    
    .status-badge { padding: 4px 8px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; background: #e0f2fe; color: #0284c7; }

    /* ACTION BAR */
    .action-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
    .search-box { position: relative; width: 300px; }
    .search-box input { padding-left: 35px; }
    .search-box i { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #9ca3af; }

    /* CHART CONTAINER */
    .chart-wrapper { background: #fff; padding: 20px; border-radius: 12px; margin-top: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }

    /* TOAST NOTIFICATION */
    #toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 1000; }
    .toast { background: #333; color: #fff; padding: 12px 20px; border-radius: 8px; margin-top: 10px; animation: slideIn 0.3s; display: flex; align-items: center; gap: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .toast.success { background: #10b981; }
    .toast.error { background: #ef4444; }
    @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

    /* RESPONSIVE */
    @media(max-width: 768px) {
      body { flex-direction:column; overflow-y: auto; }
      .sidebar { width:100%; flex-direction:row; padding: 0; align-items: center; height: 60px; }
      .brand { display: none; }
      .sidebar ul { display: flex; padding: 0; margin: 0; justify-content: space-around; width: 100%; }
      .sidebar li { padding: 10px; border-left: none; border-bottom: 4px solid transparent; flex-direction: column; gap: 5px; font-size: 0.7rem; }
      .sidebar li.active { border-left: none; border-bottom-color: var(--secondary); background: transparent; }
      .sidebar li i { font-size: 1.2rem; }
      .content { padding: 15px; }
      .action-bar { flex-direction: column; align-items: stretch; }
      .search-box { width: 100%; }
      th, td { padding: 10px; }
    }
  </style>

  <script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-firestore-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

  <div class="sidebar">
    <div class="brand">
      <h2>PAU<span>-MOVs</span></h2>
    </div>
    <ul>
      <li class="active" data-section="dashboard"><i class="fas fa-chart-pie"></i> Dashboard</li>
      <li data-section="movs"><i class="fas fa-table"></i> MOVs</li>
      <li data-section="reports"><i class="fas fa-file-alt"></i> Reports</li>
    </ul>
  </div>

  <div class="content">
    
    <div id="toast-container"></div>

    <section id="dashboard" class="section active">
      <h1>Dashboard Overview</h1>
      
      <div class="summary" id="category-summary"></div>

      <div style="background:#fff; padding:15px; border-radius:8px; display:flex; gap:15px; align-items:center; flex-wrap:wrap; margin-bottom:20px; box-shadow:0 2px 4px rgba(0,0,0,0.05);">
        <div>
          <label for="year-filter">Select Year:</label>
          <select id="year-filter"></select>
        </div>
        <div>
          <label for="quarter-filter">Quarter:</label>
          <select id="quarter-filter">
            <option value="all">All Quarters</option>
            <option value="1">Q1</option>
            <option value="2">Q2</option>
            <option value="3">Q3</option>
            <option value="4">Q4</option>
          </select>
        </div>
        <button id="toggle-view-btn" class="btn btn-secondary"><i class="fas fa-exchange-alt"></i> Toggle View</button>
      </div>

      <div id="quarterly-summary"></div>

      <div class="chart-wrapper">
        <canvas id="myChart" height="80"></canvas>
      </div>

      <div class="input-panel" style="margin-top:30px;">
        <h3><i class="fas fa-plus-circle"></i> Add / Edit Entry</h3>
        <br>
        <div class="input-grid">
          <div><label>Date</label><input type="date" id="input-date" /></div>
          <div><label>Type</label>
            <select id="input-type">
              <option value="IEC Videos">IEC Videos</option>
              <option value="News Release">News Release</option>
              <option value="Photo Release">Photo Release</option>
              <option value="PILU EduAksyon">PILU EduAksyon</option>
              <option value="Social Cards (others)">Social Cards (others)</option>
              <option value="Social Cards (PAU)">Social Cards (PAU)</option>
            </select>
          </div>
          <div><label>Title/Details</label><input type="text" id="input-title" placeholder="Enter title..." /></div>
          <div><label>Responsible</label><input type="text" id="input-responsible" placeholder="Name..." /></div>
          <div><label>Link</label><input type="url" id="input-link" placeholder="https://..." /></div>
          <div><label>Remarks</label><input type="text" id="input-remarks" placeholder="Optional notes" /></div>
          <div style="display:flex; gap:10px;">
             <button id="add-mov" class="btn btn-primary"><i class="fas fa-save"></i> Save</button>
             <label for="upload-excel" class="btn btn-success" style="margin:0; text-align:center; height:100%;"><i class="fas fa-file-excel"></i> Import Excel</label>
             <input type="file" id="upload-excel" accept=".xlsx,.xls" style="display:none;" />
          </div>
        </div>
      </div>
    </section>

    <section id="movs" class="section">
      <h1>All MOVs Records</h1>
      
      <div class="action-bar">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" id="global-search" placeholder="Search by title, type, or name...">
        </div>
        <div style="display:flex; gap:10px;">
          <button id="deleteSelectedBtn" class="btn btn-danger"><i class="fas fa-trash"></i> Delete Selected</button>
          <button id="export-excel" class="btn btn-success"><i class="fas fa-file-export"></i> Export</button>
          <button id="print-table" class="btn btn-secondary"><i class="fas fa-print"></i> Print</button>
        </div>
      </div>

      <div class="table-container">
        <table id="movs-table">
          <thead>
            <tr>
              <th width="40"><input type="checkbox" id="selectAll"></th>
              <th data-sort="date">Date <i class="fas fa-sort"></i></th>
              <th data-sort="type">Type <i class="fas fa-sort"></i></th>
              <th data-sort="title">Title/Details <i class="fas fa-sort"></i></th>
              <th data-sort="responsible">Responsible <i class="fas fa-sort"></i></th>
              <th data-sort="link">Link</th>
              <th data-sort="remarks">Remarks</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            </tbody>
        </table>
      </div>
    </section>

    <section id="reports" class="section">
      <h1>Generate Reports</h1>
      
      <div class="input-panel">
        <div class="input-grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));">
          <div><label>Month</label><input type="month" id="filter-month" /></div>
          <div><label>Type</label>
            <select id="filter-type">
              <option value="">All Categories</option>
              <option value="IEC Videos">IEC Videos</option>
              <option value="News Release">News Release</option>
              <option value="Photo Release">Photo Release</option>
              <option value="PILU EduAksyon">PILU EduAksyon</option>
              <option value="Social Cards (others)">Social Cards (others)</option>
              <option value="Social Cards (PAU)">Social Cards (PAU)</option>
            </select>
          </div>
          <div><label>&nbsp;</label><button id="filter-report" class="btn btn-primary">Apply Filter</button></div>
          <div><label>&nbsp;</label><button id="export-report" class="btn btn-success">Export</button></div>
          <div><label>&nbsp;</label><button id="print-report" class="btn btn-secondary">Print</button></div>
        </div>
      </div>

      <div class="summary">
         <div class="card" style="border-top-color: var(--primary);">
            <h3>Total Records Found</h3>
            <p id="report-total">0</p>
         </div>
      </div>

      <div class="table-container">
        <table id="report-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Type</th>
              <th>Title</th>
              <th>Responsible</th>
              <th>Link</th>
              <th>Remarks</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

  </div>

<script>
/***********************************
 * 1. FIREBASE CONFIG              *
 ***********************************/
const firebaseConfig = {
  apiKey: "AIzaSyBTMtGna6DHyqdSxvmEsIRL-ffWEbR-Cmk",
  authDomain: "pau-movs.firebaseapp.com",
  projectId: "pau-movs",
  storageBucket: "pau-movs.firebasestorage.app",
  messagingSenderId: "502537936923",
  appId: "1:502537936923:web:5f7c97f1469efc9a9b18be",
  measurementId: "G-SCJBGH476G"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const movsColl = db.collection('movs');

/***********************************
 * 2. STATE & CONSTANTS            *
 ***********************************/
const TYPES = [
  'IEC Videos', 'News Release', 'Photo Release', 
  'PILU EduAksyon', 'Social Cards (others)', 'Social Cards (PAU)'
];
let movsData = []; 
let filteredMovsData = []; // For search filtering
let editingId = null;
let chartInstance = null;
let quarterlyViewMode = 'table';

/***********************************
 * 3. NAVIGATION                   *
 ***********************************/
const sidebarItems = document.querySelectorAll('.sidebar li');
const sections = document.querySelectorAll('.section');

sidebarItems.forEach(item => {
  item.addEventListener('click', () => {
    sidebarItems.forEach(i => i.classList.remove('active'));
    item.classList.add('active');
    sections.forEach(sec => sec.classList.remove('active'));
    document.getElementById(item.dataset.section).classList.add('active');
    if(item.dataset.section === 'reports') buildReport();
  });
});

/***********************************
 * 4. TOAST NOTIFICATIONS (UI)     *
 ***********************************/
function showToast(message, type = 'success') {
  const container = document.getElementById('toast-container');
  const toast = document.createElement('div');
  toast.className = `toast ${type}`;
  toast.innerHTML = `<i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i> <span>${message}</span>`;
  container.appendChild(toast);
  setTimeout(() => {
    toast.style.animation = 'slideIn 0.3s reverse forwards';
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

/***********************************
 * 5. CRUD OPERATIONS              *
 ***********************************/
async function addMOV(rec) {
  await movsColl.add({
    ...rec,
    sortDate: parseToDate(rec.date),
    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
    updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
  });
}

async function updateMOV(id, rec) {
  await movsColl.doc(id).update({
    ...rec,
    sortDate: parseToDate(rec.date),
    updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
  });
}

async function deleteMOV(id) {
  await movsColl.doc(id).delete();
}

// Add/Save Button Logic
document.getElementById('add-mov').addEventListener('click', async () => {
  const title = document.getElementById('input-title').value.trim();
  if(!title) { showToast('Please enter a Title', 'error'); return; }

  const rec = {
    date: document.getElementById('input-date').value || todayISO(),
    type: document.getElementById('input-type').value,
    title: title,
    responsible: document.getElementById('input-responsible').value.trim(),
    link: document.getElementById('input-link').value.trim(),
    remarks: document.getElementById('input-remarks').value.trim(),
  };

  try {
    if(editingId) {
      await updateMOV(editingId, rec);
      showToast('Record updated successfully');
    } else {
      await addMOV(rec);
      showToast('Record added successfully');
    }
    resetForm();
  } catch(err) {
    console.error(err);
    showToast('Operation failed: ' + err.message, 'error');
  }
});

function resetForm() {
  document.getElementById('input-date').value = todayISO();
  document.getElementById('input-title').value = '';
  document.getElementById('input-responsible').value = '';
  document.getElementById('input-link').value = '';
  document.getElementById('input-remarks').value = '';
  editingId = null;
  document.getElementById('add-mov').innerHTML = '<i class="fas fa-save"></i> Save';
}

/***********************************
 * 6. RENDERING (Table & Dashboard)*
 ***********************************/
function renderAll() {
  // If no search active, use full data
  const dataToRender = document.getElementById('global-search').value ? filteredMovsData : movsData;
  renderMOVsTable(dataToRender);
  renderCategorySummary();
  renderQuarterlySummary();
  updateChart();
}

function renderMOVsTable(data) {
  const tbody = document.querySelector('#movs-table tbody');
  const esc = s => String(s??'').replace(/[&<>"']/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;"}[c]));
  
  tbody.innerHTML = data.map(rec => {
    const linkDisplay = rec.link ? `<a href="${esc(rec.link)}" target="_blank" class="status-badge"><i class="fas fa-external-link-alt"></i> Link</a>` : '';
    return `<tr data-id="${rec.id}">
      <td><input type="checkbox" class="rowCheckbox"></td>
      <td>${esc(rec.date)}</td>
      <td><span style="font-weight:500;">${esc(rec.type)}</span></td>
      <td>${esc(rec.title)}</td>
      <td>${esc(rec.responsible)}</td>
      <td>${linkDisplay}</td>
      <td>${esc(rec.remarks)}</td>
      <td>
        <button class="btn btn-secondary edit" style="padding:5px 10px; font-size:0.8rem;"><i class="fas fa-edit"></i></button>
        <button class="btn btn-danger delete" style="padding:5px 10px; font-size:0.8rem;"><i class="fas fa-trash"></i></button>
      </td>
    </tr>`;
  }).join('');
}

// Search Feature
document.getElementById('global-search').addEventListener('input', (e) => {
  const term = e.target.value.toLowerCase();
  filteredMovsData = movsData.filter(item => 
    (item.title && item.title.toLowerCase().includes(term)) ||
    (item.type && item.type.toLowerCase().includes(term)) ||
    (item.responsible && item.responsible.toLowerCase().includes(term))
  );
  renderMOVsTable(filteredMovsData);
});

// Edit & Delete Actions
document.querySelector('#movs-table tbody').addEventListener('click', async e => {
  const btn = e.target.closest('button');
  if(!btn) return;
  const tr = btn.closest('tr');
  const id = tr.dataset.id;
  
  if(btn.classList.contains('delete')) {
    if(confirm('Delete this entry?')) {
      try { await deleteMOV(id); showToast('Deleted successfully'); } 
      catch(err) { showToast(err.message, 'error'); }
    }
  } else if(btn.classList.contains('edit')) {
    const rec = movsData.find(r => r.id === id);
    if(rec) {
      document.getElementById('input-date').value = rec.date;
      document.getElementById('input-type').value = rec.type;
      document.getElementById('input-title').value = rec.title;
      document.getElementById('input-responsible').value = rec.responsible;
      document.getElementById('input-link').value = rec.link;
      document.getElementById('input-remarks').value = rec.remarks;
      editingId = id;
      document.getElementById('add-mov').innerHTML = '<i class="fas fa-pen"></i> Update';
      // Switch tab
      document.querySelector('[data-section="dashboard"]').click();
    }
  }
});

function renderCategorySummary() {
  const counts = {};
  TYPES.forEach(t => counts[t.toUpperCase()] = 0);
  movsData.forEach(r => {
    const typeKey = String(r.type || '').toUpperCase();
    if(counts[typeKey] !== undefined) counts[typeKey]++;
  });

  const container = document.getElementById('category-summary');
  container.innerHTML = '';
  let total = 0;
  
  TYPES.forEach(t => {
    const key = t.toUpperCase();
    const c = counts[key] || 0;
    total += c;
    container.innerHTML += `
      <div class="card">
        <h3>${t}</h3>
        <p>${c}</p>
      </div>`;
  });
  
  // Total Card
  container.innerHTML += `
    <div class="card" style="border-top-color: var(--accent);">
      <h3>Total MOVs</h3>
      <p>${total}</p>
    </div>`;
}

/***********************************
 * 7. QUARTERLY SUMMARY LOGIC      *
 ***********************************/
function renderQuarterlySummary() {
  const year = parseInt(document.getElementById('year-filter').value, 10);
  const qFilter = document.getElementById('quarter-filter').value;
  const container = document.getElementById('quarterly-summary');
  
  if(isNaN(year)) return;

  const counts = {1:{}, 2:{}, 3:{}, 4:{}};
  for(let q=1; q<=4; q++) TYPES.forEach(t => counts[q][t] = 0);

  movsData.forEach(r => {
    const d = parseToDate(r.sortDate || r.date);
    if(d.getFullYear() !== year) return;
    const q = Math.floor(d.getMonth() / 3) + 1;
    const type = TYPES.find(t => t.toLowerCase() === (r.type||'').toLowerCase());
    if(type) counts[q][type]++;
  });

  // Table View
  if(quarterlyViewMode === 'table') {
    let html = `<div class="table-container"><table class="table"><thead><tr><th>Quarter</th>`;
    TYPES.forEach(t => html += `<th>${t}</th>`);
    html += `<th>Total</th></tr></thead><tbody>`;
    
    for(let q=1; q<=4; q++) {
      if(qFilter !== 'all' && qFilter !== String(q)) continue;
      let rowTotal = 0;
      html += `<tr><td><strong>Q${q}</strong></td>`;
      TYPES.forEach(t => {
        const c = counts[q][t];
        rowTotal += c;
        html += `<td>${c}</td>`;
      });
      html += `<td><strong>${rowTotal}</strong></td></tr>`;
    }
    html += `</tbody></table></div>`;
    container.innerHTML = html;
  } else {
    // Card View
    let html = `<div class="summary">`;
    for(let q=1; q<=4; q++) {
      if(qFilter !== 'all' && qFilter !== String(q)) continue;
      let total = 0;
      let inner = '';
      TYPES.forEach(t => {
        total += counts[q][t];
        inner += `<div style="display:flex; justify-content:space-between; font-size:0.8rem; margin-bottom:4px;"><span>${t}:</span> <b>${counts[q][t]}</b></div>`;
      });
      html += `<div class="card" style="text-align:left;">
        <h3 style="font-size:1.1rem; color:var(--primary); margin-bottom:15px; border-bottom:1px solid #eee; padding-bottom:5px;">Q${q} ${year}</h3>
        ${inner}
        <div style="margin-top:10px; padding-top:10px; border-top:1px solid #eee; font-weight:bold; text-align:right;">Total: ${total}</div>
      </div>`;
    }
    html += `</div>`;
    container.innerHTML = html;
  }
}

document.getElementById('toggle-view-btn').addEventListener('click', () => {
  quarterlyViewMode = quarterlyViewMode === 'table' ? 'cards' : 'table';
  renderQuarterlySummary();
});
document.getElementById('year-filter').addEventListener('change', () => { renderQuarterlySummary(); updateChart(); });
document.getElementById('quarter-filter').addEventListener('change', renderQuarterlySummary);

/***********************************
 * 8. CHART JS IMPLEMENTATION      *
 ***********************************/
function updateChart() {
  const ctx = document.getElementById('myChart').getContext('2d');
  const counts = {};
  TYPES.forEach(t => counts[t] = 0);
  
  // Filter by selected year if needed, currently showing Total All Time stats in chart
  // Or match the year filter:
  const selectedYear = parseInt(document.getElementById('year-filter').value, 10);
  
  movsData.forEach(r => {
    const d = parseToDate(r.sortDate || r.date);
    if (!isNaN(selectedYear) && d.getFullYear() !== selectedYear) return;

    const typeKey = TYPES.find(t => t.toLowerCase() === (r.type||'').toLowerCase());
    if(typeKey) counts[typeKey]++;
  });

  const data = TYPES.map(t => counts[t]);

  if(chartInstance) chartInstance.destroy();

  chartInstance = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: TYPES,
      datasets: [{
        label: `Count (${selectedYear || 'All Time'})`,
        data: data,
        backgroundColor: [
          'rgba(54, 162, 235, 0.6)',
          'rgba(255, 99, 132, 0.6)',
          'rgba(255, 206, 86, 0.6)',
          'rgba(75, 192, 192, 0.6)',
          'rgba(153, 102, 255, 0.6)',
          'rgba(255, 159, 64, 0.6)'
        ],
        borderColor: [
          'rgba(54, 162, 235, 1)',
          'rgba(255, 99, 132, 1)',
          'rgba(255, 206, 86, 1)',
          'rgba(75, 192, 192, 1)',
          'rgba(153, 102, 255, 1)',
          'rgba(255, 159, 64, 1)'
        ],
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
}

/***********************************
 * 9. REPORTS & UTILS              *
 ***********************************/
function buildReport() {
  const monthVal = document.getElementById('filter-month').value;
  const typeVal = document.getElementById('filter-type').value;
  
  let filtered = movsData.slice();
  if(monthVal) filtered = filtered.filter(r => String(r.date).startsWith(monthVal));
  if(typeVal) filtered = filtered.filter(r => (r.type||'').toLowerCase() === typeVal.toLowerCase());
  
  const tbody = document.querySelector('#report-table tbody');
  const esc = s => String(s??'').replace(/[&<>"']/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;"}[c]));
  
  tbody.innerHTML = filtered.map(r => `<tr>
    <td>${esc(r.date)}</td>
    <td>${esc(r.type)}</td>
    <td>${esc(r.title)}</td>
    <td>${esc(r.responsible)}</td>
    <td>${r.link ? '<a href="'+r.link+'" target="_blank">Link</a>' : '-'}</td>
    <td>${esc(r.remarks)}</td>
  </tr>`).join('');
  
  document.getElementById('report-total').textContent = filtered.length;
}

document.getElementById('filter-report').addEventListener('click', buildReport);

// Date Helpers
function todayISO() {
  const d = new Date();
  return d.toISOString().split('T')[0];
}

function parseToDate(input) {
  if(!input) return new Date();
  if(typeof input === 'object' && input.toDate) return input.toDate(); // Firestore
  if(input instanceof Date) return input;
  // Excel Serial
  if(typeof input === 'number') return new Date(new Date(Date.UTC(1899, 11, 30)).getTime() + input * 86400000);
  // String DD-Mon-YYYY or YYYY-MM-DD
  const d = new Date(input);
  return isNaN(d) ? new Date() : d;
}

function populateYearDropdown() {
  const yearFilterEl = document.getElementById('year-filter');
  const years = [...new Set(movsData.map(r => {
    const d = parseToDate(r.sortDate || r.date);
    return d ? d.getFullYear() : null;
  }).filter(y => y !== null))].sort((a,b) => b-a);
  
  // Keep current selection if possible
  const current = yearFilterEl.value;
  yearFilterEl.innerHTML = years.map(y => `<option value="${y}">${y}</option>`).join('');
  
  if(years.includes(parseInt(current))) yearFilterEl.value = current;
  else if(years.length > 0) yearFilterEl.value = years[0];
}

/***********************************
 * 10. IMPORT / EXPORT             *
 ***********************************/
document.getElementById('upload-excel').addEventListener('change', async (e) => {
  const file = e.target.files[0];
  if(!file) return;
  
  try {
    const data = await file.arrayBuffer();
    const workbook = XLSX.read(data, { type: 'array' });
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });
    
    // Simple mapping assuming columns order or headers
    // Skipping extensive validation for brevity, assuming standard format
    let count = 0;
    const dataRows = rows.slice(1); // skip header
    
    for(let r of dataRows) {
      if(!r[0]) continue; // skip empty dates
      const rec = {
        date: parseToDate(r[0]).toISOString().split('T')[0],
        type: r[1] || 'IEC Videos',
        title: r[2],
        responsible: r[3],
        link: r[4] || '',
        remarks: r[5] || ''
      };
      await addMOV(rec);
      count++;
    }
    showToast(`${count} Records imported successfully`);
  } catch(err) {
    showToast('Import failed: ' + err.message, 'error');
  }
  e.target.value = ''; // reset
});

document.getElementById('export-excel').addEventListener('click', () => {
  const data = filteredMovsData.length > 0 ? filteredMovsData : movsData;
  const ws = XLSX.utils.json_to_sheet(data.map(r => ({
    Date: r.date, Type: r.type, Title: r.title, Responsible: r.responsible, Link: r.link, Remarks: r.remarks
  })));
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "MOVs");
  XLSX.writeFile(wb, "PAU_MOVs_Export.xlsx");
});

/***********************************
 * 11. BULK DELETE                 *
 ***********************************/
document.getElementById('selectAll').addEventListener('change', function() {
  document.querySelectorAll('.rowCheckbox').forEach(cb => cb.checked = this.checked);
});

document.getElementById('deleteSelectedBtn').addEventListener('click', async () => {
  const checkboxes = document.querySelectorAll('.rowCheckbox:checked');
  if(checkboxes.length === 0) { showToast('No items selected', 'error'); return; }
  
  if(!confirm(`Delete ${checkboxes.length} items?`)) return;
  
  let deleted = 0;
  for(const cb of checkboxes) {
    const id = cb.closest('tr').dataset.id;
    try { await deleteMOV(id); deleted++; } catch(e) { console.error(e); }
  }
  showToast(`${deleted} items deleted`);
  document.getElementById('selectAll').checked = false;
});

/***********************************
 * 12. INITIALIZATION              *
 ***********************************/
window.addEventListener('load', () => {
  document.getElementById('input-date').value = todayISO();
  
  // Realtime Listener
  movsColl.orderBy('sortDate', 'desc').onSnapshot(snap => {
    movsData = [];
    snap.forEach(doc => movsData.push({ id: doc.id, ...doc.data() }));
    
    populateYearDropdown();
    renderAll();
  });
});
</script>
</body>
</html>

```
